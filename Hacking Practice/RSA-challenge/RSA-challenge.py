import random
import libnum
import gmpy2

n=26609708421376677628454402900087009846291167287676911113310671001067916215975654619357943078675057781284419971876364188201285756254849493795101184689472972451252559267516902582277554505702670110528791300961267369272080284734306320521513748467464633545459859474195548892296577923424451509458569436363709731402197392186162426572460924170144815459280292038798573517240473723212917475994555278140089160884080770934882248855992019482512867322735936930918031567624003424284507526700957286437082738893899468444943650565398213516262653534101927337725614414267105976588592783298584640344155571836662897588729868409203459117059
e=65537
Cry=26609708421376677628454402900087009846291167287676911113310671001067916215975654619357943078675057781284419971876364188201285756254849493795101184689472972451252559267516902582277554505702670110528791300961267369272080284734306320521513748467464633545459859474195548892296577923424451509458569436363709731572253846238252647161985685432295738082766877396752019943012580636589164644125010073946413108951305564059881537794476457602047138719485228161010739405064157783241778448944470473298163156034126054406807297456937129548816176179704045207131224909988357244665869859061263890702529905040557579134990132844969289396259

# 
# Note that Cry=(p+520)*(q+520), and n = p*q
#

rand = random.randint(0, 30)
m='***'  # Note that the message is unkonwn, you need to get it from the encrypted message
m = libnum.s2n(m)
c1 = m**rand
c2 = gmpy2.powmod(c1, e, n)
c3 = gmpy2.powmod(c2, e, Cry)
print('Encrypted Message:', int(c3))
print('Can you decrypt this message?')
